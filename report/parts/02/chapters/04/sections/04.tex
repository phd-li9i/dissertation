Οι δύο προηγούμενες ενότητες περιγράφουν μεθόδους ελάττωσης (α) του σφάλματος
εκτίμησης προσανατολισμού όταν η εκτίμηση θέσης συμπίπτει με τη θέση του
αισθητήρα, και (β) του σφάλματος εκτίμησης θέσης όταν η εκτίμηση
προσανατολισμού ισούται με τον προσανατολισμό του αισθητήρα. Ωστόσο στη γενική
περίπτωση καμία ισότητα δεν ισχύει. Επιπλέον το πρόβλημα είναι πεπλεγμένο: το
βέλτιστο σφάλμα προσανατολισμού δεν μπορεί να επιτευχθεί όταν το σφάλμα θέσης
δεν είναι μηδέν, και το βέλτιστο σφάλμα θέσης δεν μπορεί να επιτευχθεί όταν το
σφάλμα προσανατολισμού δεν είναι μηδέν (Παρατήρηση \ref{rem:iterative}).

Σε αυτή την ενότητα παρουσιάζουμε το γενικό σύστημα που είναι ικανό να
ενσωματώσει τις τρεις μεθόδους ελάττωσης του σφάλματος εκτίμησης
προσανατολισμού και τη μέθοδο ελάττωσης του σφάλματος εκτίμησης θέσης.  Το
προτεινόμενο σύστημα μειώνει στην αρχή το πρώτο είδος σφάλματος, και στη
συνέχεια το δεύτερο. Ως συνέπεια της παρατήρησης \ref{rem:iterative}, η
διαδικασία επαναλαμβάνεται μέχρι την ικανοποίηση συνθήκης τερματισμού. Η
μέθοδος αυτή περιγράφεται στα ακόλουθα.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Περιορισμοί των μεθόδων γωνιακής ευθυγράμμισης υπό γενικές συνθήκες}
\label{subsection:02_04_04:01}

Οι μέθοδοι εκτίμησης του προσανατολισμού της στάσης $\hat{\bm{p}}$ που
παρουσιάστηκαν στην ενότητα \ref{section:02_04_02} εμφανίζουν σε πραγματικές
συνθήκες περιορισμούς ως προς την τελική τους εκτίμηση.

Η μέθοδος Πρώτων Αρχών (ενότητα \ref{subsection:02_04_02:02}) εμφανίζει μη
προβλέψιμη και ασταθή συμπεριφορά όταν ο χάρτης του περιβάλλοντος δεν το
αναπαριστά τέλεια. Στο σχήμα \ref{fig:02_04_04:errorbar_x1} απεικονίζεται το
μέσο σφάλμα προσανατολισμού της μεθόδου Πρώτων Αρχών και η τυπική του απόκλιση
σε εκατό πειράματα. Στο αριστερό σχήμα ο χάρτης αναπαριστά στην εντέλεια το
περιβάλλον, σε αντίθεση με το δεξιό σχήμα, στο οποίο ο χάρτης είναι
διεφθαρμένος.

Εδώ παρατηρούμε ότι ενώ στην πρώτη περίπτωση το σφάλμα προσανατολισμού
αυξάνεται με συνέπεια για αυξανόμενο επίπεδο διαταραχών και μειώνεται με
συνέπεια για αυξανόμενο αριθμό εκπεμπόμενων ακτίνων, στη δεύτερη δεν εμφανίζει
καμία συνέπεια. Ταυτόχρονα παρατηρούμε τον μεγαλύτερο περιορισμό της μεθόδου,
ήτοι την αδιαφορία του σφάλματος ως προς τον αριθμό εκπεμπόμενων ακτίνων όταν
ο χάρτης δεν αναπαριστά τέλεια το περιβάλλον, η οποία είναι η γενική περίπτωση.
Αυτή η ιδιότητα είναι κρίσιμη γιατί η μέθοδος λειτουργεί στον συνεχή γωνιακό
χώρο και, σε αντίθεση με τις Προκρούστειες μεθόδους των ενοτήτων
\ref{subsection:02_04_02:01} και \ref{subsection:02_04_02:03}, δεν είναι δυνατή
η εφαρμογή \textit{εσωτερικής} μεθόδου επιπρόσθετης μείωσης των σφαλμάτων της,
όπως η μέθοδος του Θησέα. Συνεπώς είναι αναγκαία η εφεύρεση νέας μεθόδου,
εξωτερικής ως προς τη λογική της μεθόδου Πρώτων Αρχών για τη μείωση των
σφαλμάτων εκτίμησής της.


\begin{figure}[h]\centering
  \vspace{2cm}
  \input{./figures/parts/02/chapters/04/sections/04/errorbar_x1.tex}
  \vspace{1cm}
  \caption{\small Μέσο σφάλμα προσανατολισμού της μεθόδου Πρώτων Αρχών και η
           τυπική του απόκλιση σε εκατό πειράματα, όπου το αρχικό σφάλμα
           προσανατολισμού $\Delta \theta = \theta-\hat{\theta}$ εξήχθη από
           ομοιόμορφη κατανομή $\Delta \theta \in
           U(-\overline{\delta}_{\theta}, +\overline{\delta}_{\theta})$, όπου
           $\overline{\delta}_{\theta} = \pi$. Τα δύο σχήματα απεικονίζουν τα
           σφάλματα προσανατολισμού για αυξανόμενη τυπική απόκλιση $\sigma_R$
           των κανονικά κατανεμημένων και μηδενικής μέσης τιμής διαταραχών της
           πραγματικής σάρωσης $\mathcal{S}_R$, $\sigma_R \in
           \{0.01,0.03,0.05,0.10\}$ m, και αυξανόμενο αριθμό εκπεμπόμενων
           ακτίνων $N_s$. Στο αριστερό σχήμα ο
           χάρτης αναπαριστά στην εντέλεια το περιβάλλον, σε αντίθεση με το
           δεξιό σχήμα, στο οποίο ο χάρτης είναι διεφθαρμένος}
  \label{fig:02_04_04:errorbar_x1}
\end{figure}

Έπειτα, οι μέθοδοι διακριτού χώρου Fourier-Mellin και Προκρούστη επηρεάζονται
από ένα διαφορετικό πρόβλημα που αναδύεται στη γενική περίπτωση. Η


\begin{figure}[h]\centering

\end{figure}




\begin{figure}[h]\centering
  \begin{subfigure}{\linewidth}
    \vspace{2cm}
    \input{./figures/parts/02/chapters/04/sections/04/fmt_non_convergence.tex}
    \vspace{1cm}
    \caption{}
    \label{fig:02_04_04:errorbar_x1}
  \end{subfigure}\\
  \begin{subfigure}{0.5\linewidth}
    \begin{onion}{1.0cm}
      \annulus[sinisn0]{0}{0}{360}[$\phi^{(0)}$]
      \annulus[sinisn1]{1}{0}{180}[$\phi_0^{(1)}$]
      \annulus[sinisn0]{1}{180}{360}[$\phi_1^{(1)}$]
      \annulus[sinisn0]{2}{0}{45}[$\phi_0^{(2)}$]
      \annulus[sinisn0]{2}{45}{90}[$\phi_1^{(2)}$]
      \annulus[sinisn0]{2}{90}{135}[$\phi_2^{(2)}$]
      \annulus[sinisn2]{2}{135}{180}[$\phi_3^{(2)}$]
      \annulus[sinisn0]{3}{135}{140.625}
      \annulus[sinisn0]{3}{140.625}{146.25}
      \annulus[sinisn0]{3}{146.25}{151.875}
      \annulus[sinisn0]{3}{151.875}{157.5}
      \annulus[sinisn3]{3}{157.5}{163.125}
      \annulus[sinisn0]{3}{163.125}{168.75}
      \annulus[sinisn0]{3}{168.75}{174.375}
      \annulus[sinisn0]{3}{174.375}{180}
    \end{onion}
  \end{subfigure}%
  \begin{subfigure}{0.5\linewidth}\vspace{-0.1cm}
    \begin{onion}{1.0cm}
      \annulus[sinisn0]{0}{0}{360}[PD$^{(0)}$]
      \annulus[litegray]{1}{0}{180}[PD$_0^{(1)}$]
      \annulus[sinisn0]{1}{180}{360}[PD$_1^{(1)}$]
      \annulus[sinisn0]{2}{0}{45}[PD$_0^{(2)}$]
      \annulus[litegray]{2}{45}{90}[PD$_1^{(2)}$]
      \annulus[sinisn0]{2}{90}{135}[PD$_2^{(2)}$]
      \annulus[sinisn0]{2}{135}{180}[PD$_3^{(2)}$]
      \annulus[sinisn0]{3}{45}{50.625}
      \annulus[sinisn0]{3}{50.625}{56.25}
      \annulus[sinisn0]{3}{56.25}{61.875}
      \annulus[sinisn0]{3}{61.875}{67.5}
      \annulus[sinisn0]{3}{67.5}{73.125}
      \annulus[sinisn0]{3}{73.125}{78.75}
      \annulus[sinisn0]{3}{78.75}{84.375}
      \annulus[litegray]{3}{84.375}{90}
    \end{onion}
  \end{subfigure}
\vspace{-1cm}
\caption{\small Τα πραγματικά δεδομένα Ποσοστών Διάκρισης
         $\texttt{PD}^{(\nu)}_{0:2^{\nu}-1}$ και επίλοιπων σφαλμάτων
         $\phi^{(\nu)}_{0:2^{\nu}-1}$ των υποψήφιων προσανατολισμών που αφορούν
         στα επίπεδα δειγματοληψίας $\nu$, τα οποία προέκυψαν κατά την εφαρμογή
         της μεθόδου Θησέα επί των μεθόδων γωνιακής ευθυγράμμισης
         Fourier-Mellin και Προκρούστη που παρουσιάζονται στην εικόνα
         \ref{fig:02_04_02:theseus}. Η κάτω σειρά απεικονίζει σχηματικά: στα
         αριστερά την αναδρομική εξέλιξη της κατάτμησης του αρχικού επίλοιπου
         σφάλματος $\phi^{(0)}$ σε ημίσεια σφάλματα, και στα δεξιά τα
         αντιστοιχούντα μέγιστα ποσοστά διάκρισης ανά βαθμό δειγματοληψίας.
         Παρατηρήστε πως υπάρχει ευθεία αντιστοιχία του μέγιστου ποσοστού
         διάκρισης (γκρι) με το ελάχιστο επίλοιπο σφάλμα προσανατολισμού}
\label{fig:02_04_02:theseus_pd}
\end{figure}







\begin{figure}[h]\centering
  \input{./figures/parts/02/chapters/04/sections/04/outer_system.tikz}
  \caption{\small Το διάγραμμα ροής του FSMSM. Η εκτέλεση αρχίζει με μια αρχική
           γωνιακό βαθμό δειγματοληψίας $\nu_{\min}$, η σάρωση που καταγράφεται
           από το αισθητήρα φυσικού εύρους $\mathcal{S}_R$, και ο χάρτης του
           περιβάλλοντος $\bm{M}$. Η αρχική εκτίμηση της στάσης παρέχεται από
           ένα φίλτρο παρακολούθησης κατά τη διάρκεια της ανίχνευσης της στάσης
           ή με τη μορφή μιας υπόθεσης κατά τη διάρκεια της συνολικής
           εντοπισμού. Η εσωτερική μέθοδος One-step Pose Correction (διόρθωση
           πόζας ενός βήματος) (εικ. \ref{fig:02_04_04:inner_system}) καλείται
           επαναληπτικά, ενημερώνοντας την πόζα εκτίμηση, μέχρι να επιτευχθεί
           ένας μέγιστος βαθμός γωνιακής δειγματοληψίας}
  \label{fig:02_04_04:outer_system}
\end{figure}

Έστω οι προϋποθέσεις του προβλήματος \ref{prob:02_04}, δηλαδή
η αρχική εκτίμηση εισόδου $\hat{\bm{p}}(\hat{x}, \hat{y}, \hat{\theta})$,
η πραγματική σάρωση $\mathcal{S}_R$, και ο χάρτης $\bm{M}$. Τότε
η μέθοδος ελάττωσης του συνολικού σφάλματος εκτίμησης στάσης που προτείνουμε,
την οποία ονομάζουμε Fourier Scan--to--Map-Scan Matching (FSMSM) και η οποία
παρουσιάζεται στο σχήμα \ref{fig:02_04_04:outer_system},---η μέθοδος μειώνει το
σφάλμα με την επαναληπτική εκτέλεση της διαδικασίας ελάττωσης σφάλματος ενός
βήματος (One-step Pose Correction, OPC---σχήμα \ref{fig:02_04_04:inner_system}),
μέχρι να ικανοποιηθεί ένα σύνολο συνθηκών τερματισμού. Η FSMSM ξεκινά με ένα
αρχικό βαθμό δειγματοληψίας του χάρτη $\nu$ = $\nu_{\min}$. Η εκτίμηση της
στάσης εισόδου επεξεργάζεται από την OPC, και η έξοδός της
$\hat{\bm{p}}^\prime$ εξετάζεται ως προς συνθήκες ανάκτησης και
σύγκλισης. Εάν η προκύπτουσα εκτίμηση στάσης βρεθεί εκτός του χάρτη $\bm{M}$
τότε δημιουργείται μια νέα εκτίμηση από την αρχική
εκτίμηση, και η διαδικασία επανεκιννεί. Εάν δεν παρατηρείται σημαντική
διόρθωση της εκτίμησης
$\|\hat{\bm{p}}^\prime-\hat{\bm{p}}\|_2 < \varepsilon_{\delta p}$, τότε ο
βαθμός δειγματοληψίας του χάρτη $\nu$ αυξάνεται. Η αύξησή του χρησιμεύει ως
μέσο μείωσης του σφάλματος προσανατολισμού και συνεπώς του σφάλματος εκτίμησης
θέσης (Παρατήρηση \ref{remark:loc_prop_or}). Διαφορετικά, η διαδικασία
διόρθωσης της στάσης σε ένα βήμα είναι η εξής επαναλαμβάνεται έως ότου δεν
παρατηρηθεί σημαντική διόρθωση. Η διαδικασία επαναλαμβάνεται έως ότου
επιτευχθεί ο μέγιστος βαθμός δειγματοληψίας χάρτη $\nu$ = $\nu_{\max}$, σε
οπότε το FSMSM τερματίζει εάν πληρούται μια τελική συνθήκη. Αυτή η τελική
συνθήκη διευκολύνει την αποφυγή τοπικών μεγίστων. Στην περίπτωση που αυτό το
συνθήκη δεν ικανοποιείται, δημιουργείται μια νέα πόζα και η διαδικασία
επαναφέρεται.

\begin{figure}[h]\centering
  \input{./figures/parts/02/chapters/04/sections/04/inner_system.tikz}
  \caption{\small  βασική μέθοδος ευθυγράμμισης πόζας του FSMSM, που ονομάζεται
           One-step Pose Correction}
  \label{fig:02_04_04:inner_system}
\end{figure}


Δεδομένης μιας εκτίμησης πόζας εισόδου $\hat{\bm{p}}(\hat{x}, \hat{y},
\hat{\theta})$, η πραγματική σάρωση $\mathcal{S}_R$, ο χάρτης $\bm{M}$ και ένας
βαθμός δειγματοληψίας $\nu$, το σύστημα διόρθωσης πόζας ενός βήματος υπολογίζει
πρώτα εκτιμήσεις πόζας $2^\nu$ $\hat{\bm{P}}_{OC} = \{(\hat{x}, \hat{y},
\hat{\theta}_k)\}$, $k = 0,\dots,2^\nu$$-$$1$. Το σύστημα διόρθωσης
προσανατολισμού χρησιμοποιεί τον αλγόριθμο \ref{alg:algorithm_ufrcnu}. Η
λειτουργία του συμβολίζεται στο σχήμα.  \ref{fig:02_04_04:inner_system} με τον τελεστή
OC$(\cdot)$.

Τώρα, εάν η θέση της εκτίμησης της πόζας εισόδου συμπίπτει με τη θέση του του
πραγματικού αισθητήρα, η μετρική Percent Discrimination (εξ. \ref{eq:pd}) θα
αρκούσε για να χρησιμεύσει ως ακριβής προσδιοριστής της εκτίμησης της πόζας με
τον ελάχιστο σφάλμα προσανατολισμού. Στην πράξη, ωστόσο, η κατάταξη που
παρέχεται από την Percent Discrimination μετρική, μπερδεύεται από την ασυνέπεια
των δύο θέσεων.  Προκειμένου να αμβλυνθεί αυτό το φαινόμενο, κάθε εκτίμηση
στάσης στο $\hat{\bm{P}}_{OC}$ δίνεται στο σύστημα διόρθωσης θέσης, όπου η θέση
κάθε εκτίμησης πόζας μετατοπίζεται μία φορά ($I$=$1$), σύμφωνα με την
Αλγόριθμος \ref{alg:algorithm_icte}. Αυτή η λειτουργία, που συμβολίζεται με τον
τελεστή RPC$(\cdot)$ στην εικ. \ref{fig:02_04_04:inner_system}, παράγει το σύνολο
$\hat{\bm{P}}_{RPC} = \{(\hat{x}_k, \hat{y}_k, \hat{\theta}_k)\}$,
$|\hat{\bm{P}}_{RPC}| = 2^\nu$.  Ο σκοπός αυτής της πράξης είναι να να παρέχει
μια εκ των προτέρων εικόνα του επόμενου βήματος της διόρθωσης της θέσης: το
λιγότερο περιστροφικά κακή ευθυγράμμιση είναι μια εκτίμηση της στάσης, τόσο
λιγότερο θα αποκλίνει ως προς την προσανατολισμού και συνεπώς της θέσης σε
σχέση με την πραγματική θέση του αισθητήρα μόλις εισάγεται στο σύστημα
διόρθωσης θέσης (παρατήρηση \ref{remark:loc_prop_or}).  Αυτή η απόκλιση
αποτυπώνεται από το αθροιστικό απόλυτο σφάλμα ανά ακτίνα (CAER) μετρική:
\begin{align}
  \text{CAER}_k = & \sum\limits_{n=0}^{N_s-1} \Bigg| \mathcal{S}_R[n] - \mathcal{S}_V[n]\Big|_{(\hat{x}_k, \hat{y}_k, \hat{\theta}_k)} \Bigg|
  \label{eq:caer}
\end{align}
όπου $k$ = $0,\dots,2^\nu$$-$$1$. Η μετρική CAER (εικ. \ref{fig:02_04_04:caer})
κωδικοποιεί ταυτόχρονα ένα βαθμό ευθυγράμμισης της θέσης και του
προσανατολισμού μεταξύ των δύο σαρώσεων εισόδου της.\footnote{Αντίθετα, η
αφαίρεση της απόλυτης τιμής θα παρείχε μόνο μια μετρική ευθυγράμμισης θέσης.}
Με την επανάληψη του διόρθωση θέσης κάθε εκτίμησης της θέσης στο
$\hat{\bm{P}}_{OC}$ και την καταγραφή την CAER για κάθε μια από τις
μετατοπισμένες εκτιμήσεις πόζας στο $\hat{\bm{P}_{RPC}}$, είναι είναι δυνατόν
να καθοριστεί μια κατάταξη σφάλματος πόζας μεταξύ των εκτιμήσεων πόζας στο
$\hat{\bm{P}}_{OC}$ και ταυτόχρονα να διατηρείται μόνο μία εκτίμηση πόζας για
την την επόμενη επανάληψη της μεθόδου διόρθωσης πόζας ενός
βήματος.\footnote{Αλλιώς, η διόρθωση της θέσης των εκτιμήσεων πόζας $2^\nu$ και
η επανατροφοδότησή τους στην διόρθωση πόζας ενός βήματος θα προκαλούσε εκθετικό
κόστος σε χρόνο εκτέλεσης.} Η εκτίμηση πόζας $\hat{\bm{p}}_C \in
\hat{\bm{P}}_{OC}$ η οποία, όταν μεταφράζεται μία φορά, καταγράφει το ελάχιστο
CAER μεταξύ όλων των παρόμοια επεξεργασμένων πόζων εκτιμήσεις στο
$\hat{\bm{P}}_{OC}$ εισάγεται στη μέθοδο διόρθωσης θέσης proper. Ο αριθμός των
επαναλήψεων μετάφρασης $I$ που υφίσταται είναι ένας αυξανόμενος συνάρτηση του
βαθμού δειγματοληψίας του χάρτη $\nu$.\footnote{Η λογική της αλυσιδωτής
σύνδεσης του αριθμού των μεταφραστικών επαναλήψεων με το βαθμό δειγματοληψίας
του χάρτη $\nu$ είναι η ακόλουθη.  Δεδομένου ότι το σφάλμα προσανατολισμού
είναι αντιστρόφως ανάλογο με το $\nu$, σε χαμηλούς βαθμούς δειγματοληψίας
χάρτη, όταν το σφάλμα εκτίμησης θέσης είναι στο υψηλότερο, εάν ο αριθμός των
μεταφραστικών επαναλήψεων ήταν υψηλός, τότε η θέση εκτίμηση της θέσης θα ήταν
ευάλωτη σε απόκλιση. Επομένως, ο αριθμός των μεταφραστικών επαναλήψεων
διατηρείται χαμηλός στα αρχικά στάδια έτσι ώστε να υπάρχει ισορροπία μεταξύ της
μείωσης του σφάλματος θέσης και της απόκλισης θέσης. Σε υψηλότερα τιμές του
$\nu$, το σφάλμα εκτίμησης προσανατολισμού μειώνεται και στη συνέχεια η
απόκλιση περιορίζεται ή/και ικανοποιείται σε υψηλότερες τιμές μεταφραστικής
επανάληψης.  Καθώς η εκτίμηση προσανατολισμού γίνεται όλο και πιο ακριβής, το
σύστημα διόρθωσης θέσης αφήνεται να επαναλάβει περισσότερες φορές, ώστε να
μειωθεί περαιτέρω το σφάλμα θέσης να είναι εφικτό.} Το σύστημα διόρθωσης θέσης
παράγει $\hat{\bm{p}}^\prime$, το οποίο στη συνέχεια τροφοδοτείται πίσω στο
σύστημα διόρθωσης προσανατολισμού με τη μορφή του νέου του εκτίμησης της θέσης
$\hat{\bm{p}} \leftarrow \hat{\bm{p}}^\prime$. Στην πράξη, η σύνολο πόζας
$\hat{\bm{P}}_{OC}$ συμπληρώνεται με μία πόζα της οποίας η θέση είναι ίση με
$\hat{\bm{p}}$ και του οποίου ο προσανατολισμός είναι ίσος με τον
προσανατολισμό του $\hat{\bm{p}}_C$ που παράγει το ελάχιστο CAER με την πάροδο
του χρόνου. Αυτή η προσθήκη εισάγει μια μορφή μνήμης στο σύστημα, η οποία το
βοηθά στην αποφυγή απόκλιση και η οποία, ως εκ τούτου, ωφελεί την ταχύτητα
εκτέλεσης.


\begin{figure}[h]\centering
  \input{./figures/parts/02/chapters/04/sections/04/caer_x2.tex}
  \vspace{1cm}
  \caption{\small Ένα προφίλ της μετρικής CAER (eq. (\ref{eq:caer})) από το
           $10^6$ ζεύγη δειγματοληπτικών σαρώσεων, ανάλογα με την απόσταση
           $(\Delta x^2 + \Delta y^2)^{1/2}$ και του σχετικού προσανατολισμού
           $\Delta \theta$ των θέσεων από όπου μια πραγματική και μια εικονική
           σάρωση καταγράφηκαν. Οι εκτιμήσεις πόζας που είναι πιο κοντά στην
           πραγματική πόζα από την άποψη των προσανατολισμού (α) παρουσιάζουν
           χαμηλότερες τιμές CAER από εκείνες που απέχουν περισσότερο.  από
           αυτήν και (β) παράγουν χαμηλότερα σφάλματα θέσης μόλις εισαχθούν στο
           Σύστημα διόρθωσης θέσης}
  \label{fig:02_04_04:caer}
\end{figure}
